#!/usr/bin/env python

from argparse import ArgumentParser
from logging import getLogger

from sqlalchemy import create_engine

from almapipo import db_connect, db_setup, logfile_setup

parser_description = """Create all tables necessary for the package almapipo
and view SQLAlchemy logs on stdout. If you run into any issues, check your
environment variables and the permissions for the database."""

# provide -h information on the script
parser = ArgumentParser(
    description=parser_description,
    epilog="")

args = parser.parse_args()

# logfile
logger = getLogger('db_create_tables')
logfile_setup.log_to_stdout(logger)
logfile_setup.log_to_stdout(db_setup.logger)

# create the tables

connection_params = db_connect.params
db_engine = create_engine(connection_params, echo=True)

db_setup.Base.metadata.create_all(db_engine)
